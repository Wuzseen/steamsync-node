!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.SimpleTable=e()}}(function(){return function e(t,a,n){function r(l,s){if(!a[l]){if(!t[l]){var i="function"==typeof require&&require;if(!s&&i)return i(l,!0);if(o)return o(l,!0);var c=new Error("Cannot find module '"+l+"'");throw c.code="MODULE_NOT_FOUND",c}var u=a[l]={exports:{}};t[l][0].call(u.exports,function(e){var a=t[l][1][e];return r(a?a:e)},u,u.exports,e,t,a,n)}return a[l].exports}for(var o="function"==typeof require&&require,l=0;l<n.length;l++)r(n[l]);return r}({1:[function(e,t,a){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(a,"__esModule",{value:!0});var l=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),s=React.createClass({displayName:"ButtonAdd",onClick:function(){this.props.onClick()},onTouchEnd:function(){this.props.onTouchEnd()},render:function(){return React.createElement(Button,{bsStyle:"info",onClick:this.onClick,onTouchEnd:this.onTouchEnd},"Add New Entry")}}),i=React.createClass({displayName:"SimpleTableBody",loadFromServer:function(e){var t="&page="+e;this.props.urloptions&&(t=t+"&"+this.props.urloptions),$.ajax({url:this.props.url+"?method=get"+t,dataType:"json",cache:!1,success:function(e){this.setState({data:e})}.bind(this),error:function(e,t,a){"Unauthorized"==a.toString()&&this.onUnauthorized(!1),console.error(this.props.url,t,a.toString())}.bind(this)})},onUpdate:function(e){var t=this.state.data;delete t.values[e.id],this.setState({data:t})},getInitialState:function(){return{data:{columns:[],values:[],authorized:!0,totals:[]}}},componentDidMount:function(){this.loadFromServer(0),this.refreshInterval=setInterval(this.loadFromServer,this.props.pollInterval)},componentWillUnmount:function(){clearInterval(this.refreshInterval)},onFormSubmit:function(e){var t=this.state.data;t.values.push(e.data),this.setState({data:t})},onUnauthorized:function(e){window.location="login"},handlePaginatorClick:function(e){this.loadFromServer(e)},getLargeModal:function(){return React.createElement(m,{columns:this.state.data.columns,onFormSubmit:this.onFormSubmit,url:this.props.url})},render:function(){var e=(this.props.url,this.props.urloptions,null);for(var t in this.state.data.columns){var a=this.state.data.columns[t];"primary"==a.type&&(e=a.name)}var n="";return"true"==this.props.addButton&&(n=React.createElement(s,{onClick:ModalManager.create.bind(this,this.getLargeModal()),onTouchEnd:ModalManager.create.bind(this,this.getLargeModal())})),React.createElement("div",null,n,React.createElement(Table,{id:this.props.tableid,className:"display",cellSpacing:"0",width:"100%"},React.createElement(c,{columns:this.state.data.columns}),React.createElement("tbody",null,this.state.data.values.map(function(t,a){return React.createElement(u,{key:a,row:t,id:a,data:this.state.data,idcol:e,url:this.props.url,urloptions:this.props.urloptions,onUpdate:this.onUpdate})},this))),React.createElement(f,{totals:this.state.data.totals,onClick:this.handlePaginatorClick}))}}),c=React.createClass({displayName:"SimpleTableHead",render:function(){return React.createElement("thead",null,React.createElement("tr",null,this.props.columns.map(function(e,t){return 1!=e.hidden?React.createElement("th",{key:t},e.label):void 0})))}}),u=React.createClass({displayName:"SimpleTableRow",renderEditable:function(){$(".xeditable").editable({mode:"popup",type:"text",url:this.props.url+"?method=update",success:this.editSuccess}),$(".xeditable_boolean").editable({mode:"popup",type:"text",url:this.props.url+"?method=update",source:[{value:1,text:"Enabled"},{value:0,text:"Disabled"}],success:this.editSuccess}),$(".xeditable_select").editable({mode:"popup",type:"text",url:this.props.url+"?method=update",source:this.selectSrc(this.current_col),success:this.editSuccess})},componentDidMount:function(){this.renderEditable()},onUpdate:function(e){this.props.onUpdate(e)},editSuccess:function(e,t){return 0!=e.result?null==e.msg?"Undefined error":e.msg:void 0},selectSrc:function(e){if("undefined"==typeof e)return!1;var t=[];for(var a in e.values)t.push({value:a,text:e.values[a]});return t},render:function(){var e=this.props.row[this.props.idcol];return React.createElement("tr",{key:e},this.props.data.columns.map(function(t,a){t.name;if(1!=t.hidden){if("subtable"==t.type){var n=this.props.idcol+"="+e;return React.createElement("td",{key:a},React.createElement(p,{onUpdate:this.onUpdate,pk:e,url:this.props.url,id:this.props.id,dataurl:t.url,qs:n,title:t.label}))}return"button_delete"==t.type?React.createElement("td",{key:a},React.createElement(h,{onUpdate:this.onUpdate,pk:e,url:this.props.url,id:this.props.id})):t.editable?"boolean"==t.type?React.createElement("td",{key:a},React.createElement("a",{href:"#",key:a,className:"xeditable_boolean","data-type":"select","data-title":t.label,"data-pk":e,"data-name":t.name,"data-value":this.props.row[t.name]},1==this.props.row[t.name]?"Enabled":"Disabled")):"select"==t.type?(this.current_col=t,React.createElement("td",{key:a,className:0===a?"text-left":""},React.createElement("a",{href:"#",key:a,className:"xeditable_select","data-type":"select","data-title":t.label,"data-pk":e,"data-name":t.name,"data-value":this.props.row[t.name]},t.values[this.props.row[t.name]]))):React.createElement("td",{key:a,className:0===a?"text-left":""},React.createElement("a",{href:"#",key:a,className:"xeditable","data-type":"text","data-title":t.label,"data-pk":e,"data-name":t.name},this.props.row[t.name])):React.createElement("td",{key:a},this.props.row[t.name])}},this))}}),d=React.createClass({displayName:"SubtableModal",render:function(){return React.createElement(Modal,null,React.createElement(ModalHeader,null,React.createElement(Button,{onClick:ModalManager.remove,onTouchEnd:ModalManager.remove,close:!0}),React.createElement("h4",{className:"modal-title"},this.props.title)),React.createElement(ModalBody,null,React.createElement(b,{url:this.props.dataurl,urloptions:this.props.qs})),React.createElement(ModalFooter,null))}}),p=React.createClass({displayName:"ButtonSubtable",getSubtableModal:function(){return React.createElement(d,{dataurl:this.props.dataurl,qs:this.props.qs,title:this.props.title})},render:function(){return React.createElement(Button,{bsStyle:"small outlined default",onClick:ModalManager.create.bind(this,this.getSubtableModal()),onTouchEnd:ModalManager.create.bind(this,this.getSubtableModal())},"Show")}}),h=React.createClass({displayName:"ButtonDelete",handleDelete:function(){confirm("Are you sure?")&&$.ajax({url:this.props.url+"?method=remove",method:"POST",data:{pk:this.props.pk,id:this.props.id},dataType:"json",cache:!1,success:function(e){this.props.onUpdate(e)}.bind(this),error:function(e,t,a){console.error(this.props.url,t,a.toString())}.bind(this)})},render:function(){return React.createElement(Button,{bsStyle:"danger",onClick:this.handleDelete},"Delete")}}),m=React.createClass({displayName:"AddFormModal",getInitialState:function(){var e=[];return this.props.columns.map(function(t,a){"default"in t&&(e[t.name]=t["default"])}),{fields:e,error_fields:[],error_message:null}},onCancel:function(){var e=[];this.props.columns.map(function(t,a){"default"in t&&(e[t.name]=t["default"])}),this.setState({fields:e}),ModalManager.remove()},changeField:function(e,t){var a=this.state.fields;a[e]=t.target.value,this.setState({fields:a})},handleSubmit:function(e){e.preventDefault();var t={};for(var a in this.state.fields)t[a]=this.state.fields[a];$.ajax({url:this.props.url+"?method=create",dataType:"json",method:"POST",data:t,success:function(e){this.handleServerResponse(e)}.bind(this),error:function(e,t,a){console.error(this.props.url,t,a.toString())}.bind(this)})},handleServerResponse:function(e){0==e.result?(this.props.onFormSubmit(e),ModalManager.remove()):this.setState({error_fields:e.fields,error_message:e.msg})},render:function(){var e="";return this.state.error_message&&(e=React.createElement(Alert,{danger:!0,collapseBottom:!0},this.state.error_message)),React.createElement(Modal,{lg:!0},React.createElement(ModalHeader,null,React.createElement(Button,{onClick:ModalManager.remove,onTouchEnd:ModalManager.remove,close:!0}),React.createElement("h4",{className:"modal-title"},"Add New Entry"),e),React.createElement(ModalBody,null,React.createElement(Form,{horizontal:!0},this.props.columns.map(function(e,t){var a="";if("undefined"!=typeof this.state.error_fields&&this.state.error_fields.length>0&&this.state.error_fields.indexOf(e.name)>-1)var a="has-error";if("select"==e.type){var n=[];for(var t in e.values)n.push(React.createElement("option",{value:t,key:t},e.values[t]));return React.createElement(FormGroup,{key:t,className:a},React.createElement(Label,{control:!0,sm:3,htmlFor:"blockhelp"},e.label),React.createElement(Col,{sm:9},React.createElement(Select,{value:this.props.value,defaultValue:this.props["default"],onChange:this.changeField.bind(this,e.name)},n)))}return"text"==e.type?React.createElement(FormGroup,{key:t,className:a},React.createElement(Label,{control:!0,sm:3,htmlFor:"blockhelp"},e.label),React.createElement(Col,{sm:9},React.createElement(Input,{type:"text",id:"blockhelp",placeholder:e.label,defaultValue:e["default"],value:this.state.fields[e.name],onChange:this.changeField.bind(this,e.name)}))):"boolean"==e.type?React.createElement(FormGroup,{key:t,className:a},React.createElement(Label,{control:!0,sm:3,htmlFor:"blockhelp"},e.label),React.createElement(Col,{sm:9},React.createElement(Checkbox,{value:"1",name:"horizontal-checkbox-options",onChange:this.changeField.bind(this,e.name)}))):void 0},this))),React.createElement(ModalFooter,null,React.createElement(Button,{outlined:!0,bsStyle:"danger",onClick:this.onCancel},"cancel")," ",React.createElement(Button,{outlined:!0,bsStyle:"lightblue",onClick:this.handleSubmit,type:"submit"},"submit")))}}),f=React.createClass({displayName:"Paginator",onClick:function(e,t){t.preventDefault(),this.props.onClick(e)},render:function(){if(void 0==this.props.totals)return React.createElement("div",null);var e=this.props.totals.maxrows,t=Math.ceil(this.props.totals.count/e),a=this.props.totals.page*e+1,n=Math.min(a+e-1,this.props.totals.count),r=[];0==this.props.totals.page?r.push(React.createElement(Page,{key:"0-0",begin:!0,disabled:!0,onClick:this.onClick.bind(this,0)})):r.push(React.createElement(Page,{key:"0-0",begin:!0,onClick:this.onClick.bind(this,0)}));for(var o=0;t>o;o++)this.props.totals.page==o?r.push(React.createElement(Page,{key:o,active:!0,onClick:this.onClick.bind(this,o)},o+1)):r.push(React.createElement(Page,{key:o,onClick:this.onClick.bind(this,o)},o+1));return this.props.totals.page==t-1?r.push(React.createElement(Page,{key:t,end:!0,disabled:!0,onClick:this.onClick.bind(this,t-1)})):r.push(React.createElement(Page,{key:t,end:!0,onClick:this.onClick.bind(this,t-1)})),React.createElement("div",null,React.createElement("div",null,"Showing ",a," to ",n," of ",this.props.totals.count," entries"),React.createElement(Pagination,null,r))}}),b=function(e){function t(){return n(this,t),r(this,Object.getPrototypeOf(t).apply(this,arguments))}return o(t,e),l(t,[{key:"render",value:function(){return React.createElement(i,{tableid:this.props.tableid,url:this.props.url,pollInterval:this.props.pollInterval,urloptions:this.props.urloptions,addButton:this.props.addButton})}}]),t}(React.Component);a["default"]=b,t.exports=a["default"]},{}]},{},[1])(1)});
//# sourceMappingURL=./build/simpletable.min.js.map